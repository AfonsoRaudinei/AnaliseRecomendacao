<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise de Solo</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- CABE√áALHO -->
        <div class="header-card">
            <div class="header-grid">
                <div class="input-group">
                    <label>Produtor</label>
                    <input type="text" placeholder="Nome do produtor">
                </div>
                <div class="input-group">
                    <label>Fazenda</label>
                    <input type="text" placeholder="Nome da fazenda">
                </div>
                <div class="input-group">
                    <label>Cidade</label>
                    <input type="text" placeholder="Cidade/UF">
                </div>
                <div class="input-group">
                    <label>Talh√£o</label>
                    <input type="text" placeholder="Identifica√ß√£o do talh√£o">
                </div>
            </div>
        </div>

        <!-- CULTURA ALVO - NOVO -->
        <div class="analysis-section">
            <div class="section-title">Cultura Alvo</div>
            <div class="inline-fields">
                <div class="inline-field" style="flex: 2;">
                    <label>Cultura</label>
                    <select class="dropdown-full" id="selectCultura">
                        <option value="">Selecione a cultura...</option>
                        <option value="soja">Soja</option>
                        <option value="milho">Milho</option>
                        <option value="cafe">Caf√©</option>
                        <option value="algodao">Algod√£o</option>
                        <option value="trigo">Trigo</option>
                        <option value="feijao">Feij√£o</option>
                        <option value="arroz">Arroz</option>
                        <option value="cana">Cana-de-a√ß√∫car</option>
                    </select>
                </div>
                <div class="inline-field">
                    <label>Produtividade</label>
                    <input type="text" class="input-compact" maxlength="7" placeholder="0" id="inputProdutividade" oninput="formatDecimal(this)">
                </div>
                <span class="unit-label">sc/ha</span>
            </div>
        </div>

        <!-- AMOSTRAS -->
        <div class="analysis-section">
            <div class="section-header-inline">
                <div class="section-title">Amostras</div>
                <div id="amostrasSelecionadasTags" class="tags-container"></div>
                <div class="dropdown-wrapper">
                    <button class="btn-add" id="btnAmostras" onclick="toggleDropdownAmostras(event)">+</button>
                    <div class="dropdown-menu" id="amostrasMenu">
                        <div class="dropdown-item" onclick="toggleAmostra('a1', 'A1', this, event)">
                            <div class="checkbox-custom"><svg class="checkmark" width="14" height="11" viewBox="0 0 14 11" fill="none"><path d="M1 5.5L5 9.5L13 1.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                            <span>Amostra 01 - Talh√£o A</span>
                        </div>
                        <div class="dropdown-item" onclick="toggleAmostra('a2', 'A2', this, event)">
                            <div class="checkbox-custom"><svg class="checkmark" width="14" height="11" viewBox="0 0 14 11" fill="none"><path d="M1 5.5L5 9.5L13 1.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                            <span>Amostra 02 - Talh√£o B</span>
                        </div>
                        <div class="dropdown-item" onclick="toggleAmostra('a3', 'A3', this, event)">
                            <div class="checkbox-custom"><svg class="checkmark" width="14" height="11" viewBox="0 0 14 11" fill="none"><path d="M1 5.5L5 9.5L13 1.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                            <span>Amostra 03 - Talh√£o C</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- pH -->
        <div class="analysis-section">
            <div class="section-title">pH e Interfer√™ncia na Absor√ß√£o</div>
            <div class="metric-row">
                <span class="metric-label">pH</span>
                <input type="text" class="input-compact" maxlength="4" placeholder="0.0" id="inputPH" oninput="formatDecimal(this); updatePH(this)">
                <div class="ph-status-bar">
                    <div class="ph-indicator-bg" id="ph-indicator-bg" style="width: 100%;"></div>
                    <div class="ph-indicator-marker" id="ph-indicator-marker" style="left: 0%;"></div>
                </div>
            </div>
            <div class="interference-grid">
                <div class="nutrient-interference"><div class="nutrient-name">N</div><div class="interference-value" id="int-n">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">P</div><div class="interference-value" id="int-p">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">K</div><div class="interference-value" id="int-k">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">Ca</div><div class="interference-value" id="int-ca">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">Mg</div><div class="interference-value" id="int-mg">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">S</div><div class="interference-value" id="int-s">--</div></div>
            </div>
            <div class="interference-grid" style="margin-top: 10px;">
                <div class="nutrient-interference"><div class="nutrient-name">Fe</div><div class="interference-value" id="int-fe">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">Mn</div><div class="interference-value" id="int-mn">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">Zn</div><div class="interference-value" id="int-zn">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">Cu</div><div class="interference-value" id="int-cu">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">B</div><div class="interference-value" id="int-b">--</div></div>
                <div class="nutrient-interference"><div class="nutrient-name">Mo</div><div class="interference-value" id="int-mo">--</div></div>
            </div>
        </div>

        <!-- TEXTURA DO SOLO -->
        <div class="analysis-section">
            <div class="section-title">Textura do Solo</div>
            
            <!-- ROW PRINCIPAL: Inputs esquerda + Tri√¢ngulo direita -->
            <div class="textura-layout-row">
                <!-- ESQUERDA: Inputs compactos com barras coloridas -->
                <div class="textura-col-inputs">
                    <!-- Areia: cor do tri√¢ngulo base (verde claro) -->
                    <div class="textura-row">
                        <span class="textura-label">Areia</span>
                        <input type="text" class="textura-input" maxlength="5" placeholder="0" id="inputAreia" oninput="formatDecimal(this); updateTextura()">
                        <span class="textura-pct">%</span>
                        <div class="textura-bar-wrap">
                            <div class="textura-bar textura-bar-areia">
                                <div class="textura-bar-fill" id="barAreia"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Silte: cor lima do tri√¢ngulo -->
                    <div class="textura-row">
                        <span class="textura-label">Silte</span>
                        <input type="text" class="textura-input" maxlength="5" placeholder="0" id="inputSilte" oninput="formatDecimal(this); updateTextura()">
                        <span class="textura-pct">%</span>
                        <div class="textura-bar-wrap">
                            <div class="textura-bar textura-bar-silte">
                                <div class="textura-bar-fill" id="barSilte"></div>
                            </div>
                        </div>
                    </div>
                    <!-- Argila: cor verde escuro do topo -->
                    <div class="textura-row">
                        <span class="textura-label">Argila</span>
                        <input type="text" class="textura-input" maxlength="5" placeholder="0" id="inputArgila" oninput="formatDecimal(this); updateTextura()">
                        <span class="textura-pct">%</span>
                        <div class="textura-bar-wrap">
                            <div class="textura-bar textura-bar-argila">
                                <div class="textura-bar-fill" id="barArgila"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Total + Classe compacto -->
                    <div class="textura-footer">
                        <div class="textura-total">
                            <span class="textura-total-valor" id="totalTextura">0</span>
                            <span class="textura-total-unit">% </span>
                            <span class="textura-total-icon" id="validacaoIcon">‚óã</span>
                        </div>
                        <div class="textura-classe" id="classeTextural">‚Äî</div>
                    </div>
                </div>

                <!-- DIREITA: Tri√¢ngulo GR√ÅFICO (muda conforme valores) -->
                <div class="textura-col-triangulo">
                    <svg id="trianguloTextural" viewBox="0 0 500 435" class="triangulo-svg-mini">
                        <!-- ZONAS DIN√ÇMICAS (opacidade muda com os valores) -->
                        
                        <!-- ZONA ARGILOSA (topo - marrom/terra) -->
                        <g id="zonaArgilosa">
                            <polygon points="250,2 200,88.6 300,88.6" fill="#8B4513" opacity="0"/>
                            <polygon points="200,88.6 150,175.2 350,175.2 300,88.6" fill="#A0522D" opacity="0"/>
                        </g>
                        
                        <!-- ZONA M√âDIA (centro - verde neutro) -->
                        <g id="zonaMedio">
                            <polygon points="150,175.2 100,261.8 400,261.8 350,175.2" fill="#7CB342" opacity="0"/>
                        </g>
                        
                        <!-- ZONA ARENOSA (base esquerda - azul claro) -->
                        <g id="zonaArenosa">
                            <polygon points="100,261.8 50,348.4 150,348.4 200,261.8" fill="#42A5F5" opacity="0"/>
                            <polygon points="150,261.8 100,348.4 200,348.4" fill="#64B5F6" opacity="0"/>
                        </g>
                        
                        <!-- ZONA SILTOSA (base direita - laranja) -->
                        <g id="zonaSiltosa">
                            <polygon points="300,261.8 350,348.4 450,348.4 400,261.8" fill="#FFA726" opacity="0"/>
                            <polygon points="300,261.8 250,348.4 350,348.4" fill="#FFB74D" opacity="0"/>
                        </g>
                        
                        <!-- BASE COMPLETA (tri√¢ngulo cheio de fundo) -->
                        <polygon points="50,348.4 0,435 500,435 450,348.4" fill="#E0E0E0" opacity="0.15"/>

                        <!-- Borda do tri√¢ngulo -->
                        <polygon points="250,2 500,435 0,435" fill="none" stroke="#9CA3AF" stroke-width="1.5"/>

                        <!-- Grade de refer√™ncia -->
                        <line x1="250" y1="2" x2="125" y2="218.5" stroke="#D1D5DB" stroke-width="0.6" opacity="0.3"/>
                        <line x1="250" y1="2" x2="175" y2="131.9" stroke="#D1D5DB" stroke-width="0.6" opacity="0.3"/>
                        <line x1="0" y1="435" x2="150" y2="348.4" stroke="#D1D5DB" stroke-width="0.6" opacity="0.3"/>
                        <line x1="500" y1="435" x2="350" y2="348.4" stroke="#D1D5DB" stroke-width="0.6" opacity="0.3"/>

                        <!-- Marcador posi√ß√£o atual (amarelo destaque) -->
                        <circle id="marcadorPosicao" cx="250" cy="300" r="6" fill="#FFC107" stroke="white" stroke-width="2.5" opacity="0" style="transition: all 0.3s; filter: drop-shadow(0 2px 4px rgba(255,193,7,0.6));"/>

                        <!-- Labels eixos -->
                        <text x="250" y="20" text-anchor="middle" font-size="10" font-weight="600" fill="#6B7280">Argila</text>
                        <text x="12" y="430" text-anchor="start" font-size="10" font-weight="600" fill="#6B7280">Silte</text>
                        <text x="488" y="430" text-anchor="end" font-size="10" font-weight="600" fill="#6B7280">Areia</text>
                        
                        <!-- Valores grandes no centro (mostram os %) -->
                        <text id="textoAreia" x="80" y="400" text-anchor="middle" font-size="20" font-weight="700" fill="#1976D2" opacity="0">0%</text>
                        <text id="textoSilte" x="420" y="400" text-anchor="middle" font-size="20" font-weight="700" fill="#F57C00" opacity="0">0%</text>
                        <text id="textoArgila" x="250" y="100" text-anchor="middle" font-size="20" font-weight="700" fill="#6D4C41" opacity="0">0%</text>
                    </svg>
                </div>
            </div>

            <!-- Cards de Tipos de Solo -->
            <div class="grid-3" style="margin-top:14px;">
                <div id="cardArgiloso" class="card-tipo-solo-micro" onclick="aplicarTipoSolo('argiloso')">
                    <span class="tipo-solo-dot" style="background:#8B4513;"></span>
                    <span class="tipo-solo-nome-micro">ARGILOSO</span>
                    <span class="tipo-solo-valores-micro">35‚Äì60%</span>
                </div>
                <div id="cardArenoso" class="card-tipo-solo-micro" onclick="aplicarTipoSolo('arenoso')">
                    <span class="tipo-solo-dot" style="background:#42A5F5;"></span>
                    <span class="tipo-solo-nome-micro">ARENOSO</span>
                    <span class="tipo-solo-valores-micro">70‚Äì90%</span>
                </div>
                <div id="cardSiltoso" class="card-tipo-solo-micro" onclick="aplicarTipoSolo('siltoso')">
                    <span class="tipo-solo-dot" style="background:#FFA726;"></span>
                    <span class="tipo-solo-nome-micro">SILTOSO</span>
                    <span class="tipo-solo-valores-micro">60‚Äì80%</span>
                </div>
            </div>

            <!-- Dica -->
            <div class="tip-box">
                <strong class="tip-icon">üí° Dica:</strong> Clique em um dos cards acima para aplicar valores t√≠picos
            </div>
        </div>

        <!-- CULTURA ALVO -->
        <div class="analysis-section">
            <div class="section-title">Cultura Alvo</div>
            <div class="grid-2">
                <div class="form-row">
                    <label>Cultura</label>
                    <select class="dropdown-full" id="selectCultura">
                        <option value="">Selecione a cultura...</option>
                        <option value="soja">Soja</option>
                        <option value="milho">Milho</option>
                        <option value="cafe">Caf√©</option>
                        <option value="cana">Cana-de-a√ß√∫car</option>
                        <option value="algodao">Algod√£o</option>
                        <option value="feijao">Feij√£o</option>
                        <option value="trigo">Trigo</option>
                    </select>
                </div>
                <div class="form-row">
                    <label>Produtividade</label>
                    <input type="text" class="input-compact" maxlength="7" placeholder="0" id="inputProdutividade" oninput="formatDecimal(this)">
                    <span class="unit-label">sc/ha</span>
                </div>
            </div>
        </div>

        <!-- SOMA DE BASES + Al + H -->
        <div class="analysis-section">
            <div class="section-title">Soma de Bases e Acidez</div>
            
            <div class="grid-2 mb-12">
                <div class="metric-row-compact">
                    <span class="metric-label">Ca (cmolc/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputCa" oninput="formatDecimal(this); calcularSBCTC()">
                    <span class="status-badge" id="statusBadgeCa">--</span>
                    <span class="percent-badge" id="percentCa">0%</span>
                    <div class="status-bar"><div class="status-indicator" id="ca-indicator"></div></div>
                </div>
                <div class="metric-row-compact">
                    <span class="metric-label">Mg (cmolc/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputMg" oninput="formatDecimal(this); calcularSBCTC()">
                    <span class="status-badge" id="statusBadgeMg">--</span>
                    <span class="percent-badge" id="percentMg">0%</span>
                    <div class="status-bar"><div class="status-indicator" id="mg-indicator"></div></div>
                </div>
            </div>

            <div class="grid-2 mb-12">
                <div class="metric-row-compact">
                    <span class="metric-label">K (cmolc/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.00" id="inputK" oninput="formatDecimal(this); calcularSBCTC()">
                    <span class="status-badge" id="statusBadgeK">--</span>
                    <span class="percent-badge" id="percentK">0%</span>
                    <div class="status-bar"><div class="status-indicator" id="k-indicator"></div></div>
                </div>
                <div class="metric-row-compact">
                    <span class="metric-label">Na (cmolc/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.00" id="inputNa" oninput="formatDecimal(this); calcularSBCTC()">
                    <span class="status-badge" id="statusBadgeNa">--</span>
                    <span class="percent-badge" id="percentNa">0%</span>
                    <div class="status-bar"><div class="status-indicator" id="na-indicator"></div></div>
                </div>
            </div>

            <div class="grid-2 mb-12">
                <div class="metric-row-compact">
                    <span class="metric-label">Al (cmolc/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputAl" oninput="formatDecimal(this); calcularSBCTC()">
                    <div class="status-bar"><div class="status-indicator" id="al-indicator"></div></div>
                </div>
                <div class="metric-row-compact">
                    <span class="metric-label">H + Al (cmolc/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputHAl" oninput="formatDecimal(this); calcularSBCTC()">
                    <div class="status-bar"><div class="status-indicator" id="hal-indicator"></div></div>
                </div>
            </div>

            <!-- CARDS SB, CTC + BARRIL V% -->
            <div class="results-container-compact">
                <div class="result-cards">
                    <div class="result-card green">
                        <div class="result-label">SB</div>
                        <div class="result-value" id="valorSB">0.00</div>
                    </div>
                    <div class="result-card blue">
                        <div class="result-label">CTC</div>
                        <div class="result-value" id="valorCTC">0.00</div>
                    </div>
                    <div class="result-card red">
                        <div class="result-label">m%</div>
                        <div class="result-value" id="valorM">0</div>
                    </div>
                    <div class="result-card red">
                        <div class="result-label">Al%</div>
                        <div class="result-value" id="valorAlPercent">0</div>
                    </div>
                </div>
                
                <!-- BARRIL V% - DESTACADO E PR√ìXIMO -->
                <div class="barrel-container">
                    <div class="barrel">
                        <div class="barrel-fill" id="barrelFill" style="height: 0%;"></div>
                        <div class="barrel-value" id="barrelValue">0%</div>
                    </div>
                    <div class="barrel-labels">
                        <span class="barrel-label-top">H+Al</span>
                        <div>
                            <span class="barrel-percent" id="barrelPercent">0</span>
                            <span class="barrel-label-bottom">V%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RELA√á√ïES DE BASES -->
            <div class="relacoes-section">
                <div class="subsection-title">Rela√ß√µes de Bases</div>
                <div class="grid-3">
                    <div class="relacao-item">
                        <div class="relacao-label">Ca/Mg</div>
                        <div class="relacao-value green" id="relacaoCaMg">--</div>
                        <div class="relacao-bar"><div id="barraCaMg" class="relacao-fill green"></div></div>
                        <div class="relacao-ideal" id="statusCaMg">3-5</div>
                    </div>
                    <div class="relacao-item">
                        <div class="relacao-label">Ca/K</div>
                        <div class="relacao-value blue" id="relacaoCaK">--</div>
                        <div class="relacao-bar"><div id="barraCaK" class="relacao-fill blue"></div></div>
                        <div class="relacao-ideal" id="statusCaK">10-30</div>
                    </div>
                    <div class="relacao-item">
                        <div class="relacao-label">Mg/K</div>
                        <div class="relacao-value orange" id="relacaoMgK">--</div>
                        <div class="relacao-bar"><div id="barraMgK" class="relacao-fill orange"></div></div>
                        <div class="relacao-ideal" id="statusMgK">3-10</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ENXOFRE E P-REM -->
        <div class="analysis-section">
            <div class="section-title">Enxofre e P-rem</div>
            <div class="grid-2">
                <div class="metric-row-compact">
                    <span class="metric-label">S (mg/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0" oninput="formatDecimal(this)">
                    <div class="status-bar"><div class="status-indicator" id="s-indicator"></div></div>
                </div>
                <div class="metric-row-compact">
                    <span class="metric-label">P-rem (mg/L)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                    <div class="status-bar"><div class="status-indicator" id="prem-indicator"></div></div>
                </div>
            </div>
        </div>

        <!-- BOT√ÉO CORRETIVO -->
        <div class="button-row">
            <div class="dropdown-wrapper">
                <button class="btn-action" onclick="toggleMenuCorretivo(event)">+ Corretivo</button>
                <div class="dropdown-menu bottom" id="correctiveMenu">
                    <div class="dropdown-item" data-type="dolomitico" onclick="toggleCorrective('dolomitico', this, event)">
                        <div class="checkbox-custom"><svg class="checkmark" width="14" height="11" viewBox="0 0 14 11" fill="none"><path d="M1 5.5L5 9.5L13 1.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                        <span>Calc√°rio Dolom√≠tico</span>
                    </div>
                    <div class="dropdown-item" data-type="calcitico" onclick="toggleCorrective('calcitico', this, event)">
                        <div class="checkbox-custom"><svg class="checkmark" width="14" height="11" viewBox="0 0 14 11" fill="none"><path d="M1 5.5L5 9.5L13 1.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                        <span>Calc√°rio Calc√≠tico</span>
                    </div>
                    <div class="dropdown-item" data-type="gesso" onclick="toggleCorrective('gesso', this, event)">
                        <div class="checkbox-custom"><svg class="checkmark" width="14" height="11" viewBox="0 0 14 11" fill="none"><path d="M1 5.5L5 9.5L13 1.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
                        <span>Gesso Agr√≠cola</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD CALAGEM -->
        <div class="recommendation-card" id="cardCalagem" style="display: none;">
            <div class="card-header">
                <div class="card-title">Calagem</div>
                <div class="card-controls">
                    <button class="control-btn" onclick="minimizeCard('cardCalagem')" title="Minimizar">‚àí</button>
                    <button class="control-btn" onclick="fecharCard('cardCalagem')" title="Fechar">√ó</button>
                </div>
            </div>
            <div class="card-content" id="contentCalagem">
                <!-- M√©todo -->
                <div class="form-section">
                    <div class="form-label">M√©todo de Calagem</div>
                    <select class="dropdown-full">
                        <option value="">Selecione o m√©todo</option>
                        <option value="albrecht">Equil√≠brio Albrecht</option>
                        <option value="albrecht-mod">Equil√≠brio Albrecht Modificado (Y)</option>
                        <option value="saturacao">Satura√ß√£o por Bases (V%)</option>
                        <option value="embrapa">M√©todo tradicional (EMBRAPA)</option>
                        <option value="ncpt">M√©todo NCpT</option>
                    </select>
                </div>

                <!-- N√≠vel Cr√≠tico + Bases do Solo em LINHA √öNICA -->
                <div class="form-section">
                    <div class="form-label">N√≠vel Cr√≠tico (cmol/dm¬≥) + Bases do Solo (%)</div>
                    <div class="inline-fields">
                        <div class="inline-field">
                            <label>Ca</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                        </div>
                        <div class="inline-field">
                            <label>Mg</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                        </div>
                        <div class="inline-field">
                            <label>K</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.00" oninput="formatDecimal(this)">
                        </div>
                        <div class="field-divider"></div>
                        <div class="inline-field">
                            <label>Ca%</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="baseCa" oninput="formatDecimal(this); calcularVPercent()">
                        </div>
                        <div class="inline-field">
                            <label>Mg%</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="baseMg" oninput="formatDecimal(this); calcularVPercent()">
                        </div>
                        <div class="inline-field">
                            <label>K%</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="baseK" oninput="formatDecimal(this); calcularVPercent()">
                        </div>
                        <div class="inline-field">
                            <label>Na%</label>
                            <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="baseNa" oninput="formatDecimal(this); calcularVPercent()">
                        </div>
                        <!-- Mini Barril V% -->
                        <div class="mini-barrel-wrapper">
                            <div class="mini-barrel">
                                <div class="mini-barrel-fill" id="miniBarrelFill" style="height: 0%;"></div>
                            </div>
                            <span class="mini-barrel-value" id="miniBarrelValue">V% 0</span>
                        </div>
                    </div>
                </div>

                <!-- Estrat√©gia -->
                <div class="form-section">
                    <div class="form-label">Elevar % das Bases</div>
                    <select class="dropdown-full">
                        <option value="">Selecione a estrat√©gia</option>
                        <option value="padrao">Seguir a recomenda√ß√£o padr√£o</option>
                        <option value="elevar-nc">Elevar % das bases e sempre respeitar o NC</option>
                        <option value="elevar-proporcao">Elevar % das bases e manter a propor√ß√£o escolhida</option>
                    </select>
                </div>

                <!-- MINI-CARD DOLOM√çTICO -->
                <div class="mini-card" id="miniDolomitico" style="display: none;">
                    <div class="mini-card-header">
                        <span>Calc√°rio Dolom√≠tico</span>
                        <button class="btn-remove" onclick="removeCorrective('dolomitico')">√ó</button>
                    </div>
                    <div class="inline-fields">
                        <div class="inline-field"><label>Ca%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>Mg%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>PR%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>PE%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>PRNT%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                    </div>
                    <div class="form-row mt-12">
                        <label>Superf√≠cie</label>
                        <select class="dropdown-compact" id="superficieDolo" onchange="toggleGradeFields('dolo')">
                            <option value="">Selecione...</option>
                            <option value="superficial">Superficial</option>
                            <option value="niveladora">Niveladora</option>
                            <option value="grade">Grade</option>
                        </select>
                    </div>
                    <!-- Campos Grade (condicionais) -->
                    <div class="grade-fields" id="gradeFieldsDolo" style="display: none;">
                        <div class="inline-fields mt-12">
                            <div class="inline-field">
                                <label>Polegadas da Grade</label>
                                <select class="dropdown-compact" id="polegadasDolo">
                                    <option value="">Selecione...</option>
                                    <option value="16">16"</option>
                                    <option value="18">18"</option>
                                    <option value="20">20"</option>
                                    <option value="22">22"</option>
                                    <option value="24">24"</option>
                                    <option value="26">26"</option>
                                    <option value="28">28"</option>
                                    <option value="32">32"</option>
                                </select>
                            </div>
                            <div class="inline-field">
                                <label>Incorpora√ß√£o (cm)</label>
                                <input type="text" class="input-compact" maxlength="5" placeholder="0" id="incorporacaoDolo" oninput="formatDecimal(this)">
                            </div>
                            <span class="unit-label" style="font-size:10px;color:#6B7280;">(-10cm mancal)</span>
                        </div>
                    </div>
                </div>

                <!-- MINI-CARD CALC√çTICO -->
                <div class="mini-card" id="miniCalcitico" style="display: none;">
                    <div class="mini-card-header">
                        <span>Calc√°rio Calc√≠tico</span>
                        <button class="btn-remove" onclick="removeCorrective('calcitico')">√ó</button>
                    </div>
                    <div class="inline-fields">
                        <div class="inline-field"><label>Ca%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>Mg%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>PR%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>PE%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>PRNT%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                    </div>
                    <div class="form-row mt-12">
                        <label>Superf√≠cie</label>
                        <select class="dropdown-compact" id="superficieCalc" onchange="toggleGradeFields('calc')">
                            <option value="">Selecione...</option>
                            <option value="superficial">Superficial</option>
                            <option value="niveladora">Niveladora</option>
                            <option value="grade">Grade</option>
                        </select>
                    </div>
                    <!-- Campos Grade (condicionais) -->
                    <div class="grade-fields" id="gradeFieldsCalc" style="display: none;">
                        <div class="inline-fields mt-12">
                            <div class="inline-field">
                                <label>Polegadas da Grade</label>
                                <select class="dropdown-compact" id="polegadasCalc">
                                    <option value="">Selecione...</option>
                                    <option value="16">16"</option>
                                    <option value="18">18"</option>
                                    <option value="20">20"</option>
                                    <option value="22">22"</option>
                                    <option value="24">24"</option>
                                    <option value="26">26"</option>
                                    <option value="28">28"</option>
                                    <option value="32">32"</option>
                                </select>
                            </div>
                            <div class="inline-field">
                                <label>Incorpora√ß√£o (cm)</label>
                                <input type="text" class="input-compact" maxlength="5" placeholder="0" id="incorporacaoCalc" oninput="formatDecimal(this)">
                            </div>
                            <span class="unit-label" style="font-size:10px;color:#6B7280;">(-10cm mancal)</span>
                        </div>
                    </div>
                </div>

                <!-- MINI-CARD GESSO -->
                <div class="mini-card" id="miniGesso" style="display: none;">
                    <div class="mini-card-header">
                        <span>Gesso Agr√≠cola</span>
                        <button class="btn-remove" onclick="removeCorrective('gesso')">√ó</button>
                    </div>
                    <div class="form-section">
                        <div class="form-label">M√©todo de Gessagem</div>
                        <select class="dropdown-full">
                            <option value="">Selecione o m√©todo</option>
                            <option value="enxofre">Pela Necessidade de Enxofre (S)</option>
                            <option value="calcio-aluminio">Pelo M√©todo da Necessidade de C√°lcio (Ca) e Redu√ß√£o de Alum√≠nio (Al)</option>
                            <option value="sulfato">Pelo Teor de Sulfato (SO‚ÇÑ¬≤‚Åª) na √Ågua de Irriga√ß√£o</option>
                        </select>
                    </div>
                    <div class="inline-fields">
                        <div class="inline-field"><label>Ca%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                        <div class="inline-field"><label>S%</label><input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)"></div>
                    </div>
                </div>

                <!-- BOT√ÉO GERAR RECOMENDA√á√ÉO -->
                <button class="btn-generate" onclick="gerarRecomendacaoCalagem()">Gerar Recomenda√ß√£o</button>

                <!-- RESULTADO -->
                <div id="resultadoCalagem" class="resultado-box" style="display: none;">
                    <div class="resultado-titulo">Recomenda√ß√£o</div>
                    <div class="resultado-items">
                        <div class="resultado-item" id="recDolomitico" style="display: none;">
                            <span class="resultado-icon">üü§</span>
                            <span class="resultado-valor" id="valorDolomitico">0.0</span>
                            <span class="resultado-unidade">ton/ha Calc√°rio Dolom√≠tico</span>
                        </div>
                        <div class="resultado-item" id="recCalcitico" style="display: none;">
                            <span class="resultado-icon">‚ö™</span>
                            <span class="resultado-valor" id="valorCalcitico">0.0</span>
                            <span class="resultado-unidade">ton/ha Calc√°rio Calc√≠tico</span>
                        </div>
                        <div class="resultado-item" id="recGesso" style="display: none;">
                            <span class="resultado-icon">üîµ</span>
                            <span class="resultado-valor" id="valorGesso">0.0</span>
                            <span class="resultado-unidade">ton/ha Gesso Agr√≠cola</span>
                        </div>
                    </div>
                    
                    <!-- GR√ÅFICO ANTES/DEPOIS -->
                    <div class="grafico-comparativo">
                        <div class="grafico-titulo">Comparativo: Antes √ó Depois</div>
                        <div class="grafico-barras">
                            <div class="grafico-nutriente">
                                <span class="grafico-label">Ca</span>
                                <div class="barras-container">
                                    <div class="barra-antes" id="barraCaAntes" style="width: 30%;"></div>
                                    <div class="barra-depois" id="barraCaDepois" style="width: 60%;"></div>
                                </div>
                                <span class="grafico-valores"><span id="valCaAntes">1.5</span> ‚Üí <span id="valCaDepois">3.0</span></span>
                            </div>
                            <div class="grafico-nutriente">
                                <span class="grafico-label">Mg</span>
                                <div class="barras-container">
                                    <div class="barra-antes" id="barraMgAntes" style="width: 25%;"></div>
                                    <div class="barra-depois" id="barraMgDepois" style="width: 50%;"></div>
                                </div>
                                <span class="grafico-valores"><span id="valMgAntes">0.5</span> ‚Üí <span id="valMgDepois">1.0</span></span>
                            </div>
                            <div class="grafico-nutriente">
                                <span class="grafico-label">S</span>
                                <div class="barras-container">
                                    <div class="barra-antes" id="barraSAntes" style="width: 20%;"></div>
                                    <div class="barra-depois" id="barraSDepois" style="width: 45%;"></div>
                                </div>
                                <span class="grafico-valores"><span id="valSAntes">5</span> ‚Üí <span id="valSDepois">12</span></span>
                            </div>
                        </div>
                        <div class="grafico-legenda">
                            <span class="legenda-item"><span class="legenda-cor antes"></span>Antes</span>
                            <span class="legenda-item"><span class="legenda-cor depois"></span>Depois</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- POT√ÅSSIO -->
        <div class="analysis-section">
            <div class="section-title">Pot√°ssio</div>
            <div class="metric-row-compact">
                <span class="metric-label">K (mg/dm¬≥)</span>
                <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                <div class="status-bar"><div class="status-indicator" id="k-mg-indicator"></div></div>
            </div>
        </div>

        <!-- BOT√ÉO POT√ÅSSIO -->
        <div class="button-row">
            <div class="dropdown-wrapper">
                <button class="btn-action" onclick="abrirSeletorRegencia('potassio')">+ Pot√°ssio</button>
            </div>
        </div>

        <!-- CARD POT√ÅSSIO -->
        <div class="recommendation-card" id="cardPotassio" style="display: none;">
            <div class="card-header">
                <div class="card-title">Indica√ß√£o de Pot√°ssio (K)</div>
                <div class="card-controls">
                    <button class="control-btn" onclick="minimizeCard('cardPotassio')">‚àí</button>
                    <button class="control-btn" onclick="fecharCard('cardPotassio')">√ó</button>
                </div>
            </div>
            <div class="card-content" id="contentPotassio">
                <div class="regencia-selecionada">
                    <span class="regencia-tag" id="tagPotassio">üìö Autor</span>
                    <button class="btn-change" onclick="abrirSeletorRegencia('potassio')">Alterar</button>
                </div>
                <div class="form-row">
                    <label>Refer√™ncia</label>
                    <select class="dropdown-compact" id="selectRefPotassio"></select>
                </div>
                <div class="form-row">
                    <label>M√©todo</label>
                    <select class="dropdown-compact" id="metodoPotassio">
                        <option value="">Selecione...</option>
                        <option value="elevar-nc">Elevar para N√≠vel cr√≠tico</option>
                        <option value="producao">Produ√ß√£o - Planta inteira</option>
                        <option value="exportacao">Exporta√ß√£o (Manuten√ß√£o)</option>
                    </select>
                </div>
                <div class="subsection-title mt-12">Fonte e Dose</div>
                <div class="inline-fields">
                    <div class="inline-field" style="flex: 2;">
                        <label>Adubo</label>
                        <select class="dropdown-full" id="aduboPotassio">
                            <option value="">Selecione...</option>
                            <option value="kcl">KCl - Cloreto de Pot√°ssio</option>
                            <option value="sulfato-k">Sulfato de Pot√°ssio</option>
                        </select>
                    </div>
                    <div class="inline-field">
                        <label>Dose</label>
                        <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="dosePotassio" oninput="formatDecimal(this)">
                    </div>
                    <span class="unit-label">kg/ha</span>
                </div>
                <button class="btn-generate" onclick="gerarRecomendacaoPotassio()">Gerar Recomenda√ß√£o</button>
                <div id="resultadoPotassio" class="resultado-simples" style="display: none;">
                    <span class="resultado-icon">üî∑</span>
                    <span id="textoPotassio"></span>
                </div>
            </div>
        </div>

        <!-- F√ìSFORO -->
        <div class="analysis-section">
            <div class="section-title">F√≥sforo</div>
            <div class="grid-2 mb-12">
                <div class="metric-row-compact">
                    <span class="metric-label">P Mehlich (mg/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                    <div class="status-bar"><div class="status-indicator" id="pmehlich-indicator"></div></div>
                </div>
                <div class="metric-row-compact">
                    <span class="metric-label">P Resina (mg/dm¬≥)</span>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                    <div class="status-bar"><div class="status-indicator" id="presina-indicator"></div></div>
                </div>
            </div>
            <div class="metric-row-compact">
                <span class="metric-label">PR %</span>
                <input type="text" class="input-compact" maxlength="5" placeholder="0.0" oninput="formatDecimal(this)">
                <div class="status-bar"><div class="status-indicator" id="pr-indicator"></div></div>
            </div>
        </div>

        <!-- BOT√ÉO F√ìSFORO -->
        <div class="button-row">
            <div class="dropdown-wrapper">
                <button class="btn-action" onclick="abrirSeletorRegencia('fosforo')">+ F√≥sforo</button>
            </div>
        </div>

        <!-- CARD F√ìSFORO -->
        <div class="recommendation-card" id="cardFosforo" style="display: none;">
            <div class="card-header">
                <div class="card-title">Indica√ß√£o de F√≥sforo (P)</div>
                <div class="card-controls">
                    <button class="control-btn" onclick="minimizeCard('cardFosforo')">‚àí</button>
                    <button class="control-btn" onclick="fecharCard('cardFosforo')">√ó</button>
                </div>
            </div>
            <div class="card-content" id="contentFosforo">
                <div class="regencia-selecionada">
                    <span class="regencia-tag" id="tagFosforo">üìö Autor</span>
                    <button class="btn-change" onclick="abrirSeletorRegencia('fosforo')">Alterar</button>
                </div>
                <div class="form-row">
                    <label>Refer√™ncia</label>
                    <select class="dropdown-compact" id="selectRefFosforo"></select>
                </div>
                <div class="form-row">
                    <label>M√©todo</label>
                    <select class="dropdown-compact" id="metodoFosforo">
                        <option value="">Selecione...</option>
                        <option value="elevar-nc">Elevar para N√≠vel cr√≠tico</option>
                        <option value="producao">Produ√ß√£o - Planta inteira</option>
                        <option value="exportacao">Exporta√ß√£o (Manuten√ß√£o)</option>
                    </select>
                </div>
                <div class="subsection-title mt-12">Fonte e Dose</div>
                <div class="inline-fields">
                    <div class="inline-field" style="flex: 2;">
                        <label>Adubo</label>
                        <select class="dropdown-full" id="aduboFosforo">
                            <option value="">Selecione...</option>
                            <option value="map">MAP - Monoam√¥nio Fosfato</option>
                            <option value="dap">DAP - Diam√¥nio Fosfato</option>
                            <option value="super-simples">Superfosfato Simples</option>
                            <option value="super-triplo">Superfosfato Triplo</option>
                        </select>
                    </div>
                    <div class="inline-field">
                        <label>Dose</label>
                        <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="doseFosforo" oninput="formatDecimal(this)">
                    </div>
                    <span class="unit-label">kg/ha</span>
                </div>
                <button class="btn-generate" onclick="gerarRecomendacaoFosforo()">Gerar Recomenda√ß√£o</button>
                <div id="resultadoFosforo" class="resultado-simples" style="display: none;">
                    <span class="resultado-icon">üî∂</span>
                    <span id="textoFosforo"></span>
                </div>
            </div>
        </div>

        <!-- MICRONUTRIENTES -->
        <div class="analysis-section">
            <div class="section-title">Micronutrientes</div>
            <div class="grid-4 mb-8">
                <div class="micro-field">
                    <label>Mn</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputMn" oninput="formatDecimal(this); updateMicroStatus('mn', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusMn"></div></div>
                </div>
                <div class="micro-field">
                    <label>Zn</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputZn" oninput="formatDecimal(this); updateMicroStatus('zn', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusZn"></div></div>
                </div>
                <div class="micro-field">
                    <label>Cu</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputCu" oninput="formatDecimal(this); updateMicroStatus('cu', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusCu"></div></div>
                </div>
                <div class="micro-field">
                    <label>Fe</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputFe" oninput="formatDecimal(this); updateMicroStatus('fe', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusFe"></div></div>
                </div>
            </div>
            <div class="grid-4">
                <div class="micro-field">
                    <label>B</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.0" id="inputB" oninput="formatDecimal(this); updateMicroStatus('b', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusB"></div></div>
                </div>
                <div class="micro-field">
                    <label>Mo</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.00" id="inputMo" oninput="formatDecimal(this); updateMicroStatus('mo', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusMo"></div></div>
                </div>
                <div class="micro-field">
                    <label>Ni</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.00" id="inputNi" oninput="formatDecimal(this); updateMicroStatus('ni', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusNi"></div></div>
                </div>
                <div class="micro-field">
                    <label>Se</label>
                    <input type="text" class="input-compact" maxlength="5" placeholder="0.00" id="inputSe" oninput="formatDecimal(this); updateMicroStatus('se', this.value)">
                    <div class="micro-status-bar"><div class="micro-status-fill" id="statusSe"></div></div>
                </div>
            </div>
        </div>

        <!-- BOT√ÉO GRUPO MICRO -->
        <div class="button-row">
            <button class="btn-action" onclick="criarGrupoMicro()">+ Grupo de Micronutrientes</button>
        </div>

        <!-- CONTAINER GRUPOS MICRO -->
        <div id="containerGruposMicro"></div>

        <!-- MODAL SELETOR REG√äNCIA -->
        <div class="modal-overlay" id="modalRegencia" onclick="fecharModalRegencia(event)">
            <div class="modal-content" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <span id="modalRegenciaTitulo">Tipo de reg√™ncia</span>
                    <button class="modal-close" onclick="fecharModalRegencia()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="regencia-option" onclick="selecionarRegencia('autor')">
                        <span>üìö Autor/Refer√™ncia</span>
                    </div>
                    <div class="regencia-option" onclick="selecionarRegencia('tecnologia')">
                        <span>‚öôÔ∏è Tecnologia</span>
                    </div>
                    <div class="regencia-option" onclick="selecionarRegencia('cultivar')">
                        <span>üå± Cultivar</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- MODAL SELETOR DE MICRONUTRIENTES -->
        <div class="modal-overlay" id="modalMicronutrientes" onclick="fecharModalMicro(event)">
            <div class="modal-content" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <span>Selecionar Micronutrientes</span>
                    <button class="modal-close" onclick="fecharModalMicro()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="micro-selector-grid" id="microSelectorGrid">
                        <!-- Preenchido dinamicamente -->
                    </div>
                    <button class="btn-confirmar-micro" onclick="confirmarSelecaoMicro()">Confirmar Sele√ß√£o</button>
                </div>
            </div>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
